"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const path_1 = require("path");
const text_1 = require("../text");
const webpack_1 = require("../webpack");
describe('stubUnsupportedModules', () => {
    it('replaces unsupported modules with stub implementation', async () => {
        const bundledApp = await webpack_1.bundle([{ name: 'index', path: path_1.resolve(__dirname, './app') }]);
        const app = new Function(bundledApp.output['index']);
        global.exports = {};
        console.warn = jest.fn();
        app();
        expect(`${global.exports.spawnPwd}`).toBe('unsupported');
        expect(console.warn).toBeCalledWith(text_1.Text.unsupported('child_process'));
    }, 10000);
});
describe('providedAliasModules', () => {
    it('replaces alias modules with provided implementations', async () => {
        const bundledApp = await webpack_1.bundle([{ name: 'index', path: path_1.resolve(__dirname, './app-alias-import') }]);
        const app = new Function(bundledApp.output['index']);
        global.exports = {};
        app();
        console.warn = jest.fn();
        expect(console.warn).not.toBeCalled();
        expect(`${global.exports.fileContent}`).toBe('Hello World');
        expect(global.exports.volContent).toEqual({ '/file.txt': 'Hello World' });
    }, 10000);
});
