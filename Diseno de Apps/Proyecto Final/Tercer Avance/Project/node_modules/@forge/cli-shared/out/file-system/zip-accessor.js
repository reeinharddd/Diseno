"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const fs_1 = tslib_1.__importDefault(require("fs"));
const unzipper_1 = require("unzipper");
class UnzipperZipAccessor {
    async extractStringFile(zipFilePath, fileToExtract) {
        const archiveListing = await unzipper_1.Open.file(zipFilePath);
        const targetFile = archiveListing.files.find(({ path }) => path === fileToExtract);
        if (targetFile) {
            return (await targetFile.buffer()).toString();
        }
    }
    extract(zipFile, extractDirectory) {
        const zipStream = fs_1.default.createReadStream(zipFile);
        const extractStream = unzipper_1.Extract({ path: extractDirectory });
        return new Promise((resolve, reject) => {
            zipStream.pipe(extractStream);
            zipStream.on('error', reject);
            extractStream.on('error', reject);
            extractStream.on('close', resolve);
        });
    }
}
exports.UnzipperZipAccessor = UnzipperZipAccessor;
