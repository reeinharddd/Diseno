"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const t = tslib_1.__importStar(require("io-ts"));
const ari_1 = require("../ari");
const config_1 = require("../config");
const ui_1 = require("../ui");
exports.appConfigShape = t.intersection([
    t.interface({
        id: t.string,
        name: t.string
    }),
    t.partial({
        description: t.string
    })
]);
exports.appConfigKey = 'app';
function adjustLegacyAppId(legacyAppDetails) {
    if (legacyAppDetails.id.startsWith('ari:')) {
        return legacyAppDetails;
    }
    return Object.assign(Object.assign({}, legacyAppDetails), { id: ari_1.appIdToAriString(legacyAppDetails.id) });
}
exports.adjustLegacyAppId = adjustLegacyAppId;
exports.assertiveAppConfigProvider = (appConfigReader) => () => config_1.assertive(appConfigReader)
    .readConfigSectionOrThrow(ui_1.Text.config.missing, ui_1.Text.config.invalid)
    .then(adjustLegacyAppId);
