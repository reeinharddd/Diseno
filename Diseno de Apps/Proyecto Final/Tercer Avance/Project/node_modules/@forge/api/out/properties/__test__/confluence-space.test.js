"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const confluence_space_1 = require("../confluence-space");
const product_scoped_storage_1 = require("../product-scoped-storage");
const confluence_versioned_storage_1 = require("../confluence-versioned-storage");
let confluenceSpaceStorage;
describe('ConfluenceSpaceStorage', () => {
    beforeEach(() => {
        confluenceSpaceStorage = new confluence_space_1.ConfluenceSpaceStorage('test123', {});
        jest.clearAllMocks();
    });
    it('should extend ConfluenceVersionedStorage class', () => {
        expect(confluenceSpaceStorage).toBeInstanceOf(confluence_versioned_storage_1.ConfluenceVersionedStorage);
    });
    it('should extend ProductScopedStorage class', () => {
        expect(confluenceSpaceStorage).toBeInstanceOf(product_scoped_storage_1.ProductScopedStorage);
    });
    it('should correctly build the API path based on the context passed to its constructor', () => {
        expect(confluenceSpaceStorage['storageApiPath']).toEqual('/wiki/rest/api/space/test123/property');
    });
    it('should override the parent class set() method and call versionedSet() instead', async () => {
        confluence_versioned_storage_1.ConfluenceVersionedStorage.prototype['versionedSet'] = jest.fn().mockResolvedValue({});
        const versionedSetSpy = jest.spyOn(confluence_versioned_storage_1.ConfluenceVersionedStorage.prototype, 'versionedSet');
        await confluenceSpaceStorage.set('testKey', 'testValue');
        expect(versionedSetSpy).toHaveBeenCalledWith('testKey', 'testValue');
    });
});
